---
title: why I close PRs
date: 2016-12-29 22:37:31
categories:
    - frontend
    - translate
tags:
    - scm
    - github
    - CI
---

    
[原文链接](http://www.jeffgeerling.com/blog/2016/why-i-close-prs-oss-project-maintainer-notes?utm_source=wanqu.co&utm_campaign=Wanqu+Daily&utm_medium=website)

我在github和其他地方维护了众多的开源项目(目前超过160)。在过去的几年里，合并或者关闭了上千的PR请求，为他们打补丁，并想要总结一下我为什么不合并的一些理由。
我的一些项目有合作的开发者，但是多数情况下只有我。效率低下，但是我通过开放的协议和鼓励fork来减轻压力。我为我的开源项目维护贡献了很多时间（平均一星期5-10小时），并自掏腰包去维护这些项目的基础设施，大约$1000一年。（比使用我的项目获取收益的公司为此捐赠的还多，:( ）
我并不趋于关闭一个没有合并的PR请求,因为一个PR意味着有人喜欢我的项目并为此贡献。但是有时这是必须的，我并不想成为一个怪人（我通常通过感谢贡献者来减少关闭请求的打击），只是想确保项目的健康发展。以下是几条我维护项目的原则，希望通过阅读他们你能够理解我为什么会关闭请求而不是合并。

### 评价一个PR请求的原则

对于我维护的项目（包括我通常工作的大多数软件），我会坚持以下几条最重要的原则，并且会关闭没有坚持这些原则的PR：

#### 任何东西都应该有良好的自动化测试

几乎我维护的所有项目都有便捷的方式通过Travis CI, Jenkins , 或者其他CI系统来执行。如果你破坏了我的测试，我就让你脸蛋开花。几乎没有例外，我不会合并没有通过测试的PR。

#### 可维护性 > 完整性

我不会迎合任何人，通常只有我自己。并且98%我维护的开源项目，我都在实际产品中使用(成百上千)。所以我喜好随它们。我不会增加我的维护负担除非它们提供了显著的功能或者明显的Bug修复。我不能维护一个我不能完全理解的项目，所以我更愿意保持轻量并而不是增加维护成本，我没有时间来负担。

#### 只迎合80%的用例

我看见过大量增加一个我完全没有见过的功能的PR。当然有一些奇葩的系统，需要在一些晦涩难懂的程序里配置牛毛般的细节。我不会添加这些代码，因为我不使用就无法担保，并且增加了维护成本，尽管它只是一个非常简单的功能。如果你是其中之一，请fork我的项目。我并不会被冒犯。我的开源项目意在解决共通的问题。我尝试通过fork或者继承来完善，保持本身的简单。

#### 使用合适的语法

通常，我将语法检查放在自动化测试中。如果我没有，请确保类似缩进，命名，换行，使用空格代替制表符这些基本的事情没问题，并遵循项目的风格。我经常合并代码之后再亲手来统一风格，但是不需要我来做这些事情更好，我更愿意合并哪些没有怪异风格的PR。

#### 不要改变结构

我见过将这个项目或者测试的结构都替换了的PR。除非我们已经在问题列表下深入的讨论过，否则我从来不会合并这样的代码。总有一个原因（实际上很多）使事情是它看起来的那样。我并不是说我的结构或者测试就总是正确的，但是我不会合并将项目改的面目全非的代码来让我更难理解我自己的项目。

#### 在一个PR里不要改变超过50行代码

(除非你有令人信服的原因)
我经常收到有人提交PR的消息，我点击进去查看，然后我看到查过20个文件800行代码的改动，一共有12个提交。如果这是一个讨论过的项目结构调整，我能够理解这样的PR, 我会花时间去理解。但是任何超过50行的变更使我的大脑无法在一个小时内进行良好的审查。

#### 结论: 默认拒绝

关于这件事情最为讽刺的是，这些提交问题和RPs的人仅仅是为了解决他们自己项目里面的问题，在代码合并之后就立即消失不见。他们意识到（通常不是很清晰）如果他们能说服我维护他们的这些零碎的代码，就能减轻技术上的负担。

如果贡献者希望和项目建立良好的关系，我很愿意交出一些结构上的控制权。但是他们必须证明自己让我可以相信他们。一些项目最好的贡献者通常是那些在工作中使用项目收益，并每周都贡献出一两个小时的时间来帮组处理问题列表，关闭失效的问题，并持续的提交PR来修复一些简单的bug（特别是和他们在项目中最熟悉的部分相关的）。

致开源项目维护者：确保你们有一些评判PR的公认原则。当PR没有达到要求，对于拒绝不要心存愧疚。许多项目加入了许多新特性而没有考虑到长期维护的价值，最终走向失控。简单的一个不字就可以避免哪些问题。
